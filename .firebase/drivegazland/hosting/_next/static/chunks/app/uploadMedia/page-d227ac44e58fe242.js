(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[704],{560:function(e,t,s){Promise.resolve().then(s.bind(s,1105))},1105:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(7437),r=s(2265),l=s(8746),i=s(8872);s(2392);var n=s(3390),o=s(263),c=s(4364),d=s(9854),u=s(9842),h=s(3908);let m=(0,d.cF)(),f=h.db,x=async(e,t,s,a,r)=>{if(!e||!e.name)throw Error("Le fichier est invalide ou manquant.");let l="".concat("image"===t?"images":"videos","/").concat(e.name,"_").concat(Date.now()),i=(0,d.iH)(m,l),n=(0,d.B0)(i,e);return new Promise((l,i)=>{n.on("state_changed",e=>{let t=Math.round(e.bytesTransferred/e.totalBytes*100);r&&r(t)},e=>{i(e)},async()=>{let r=await (0,d.Jt)(n.snapshot.ref);await (0,u.ET)((0,u.hJ)(f,"files"),{name:e.name,url:r,type:t,tags:s,addBy:a.id,createdAt:new Date}),l(r)})})},g=h.db,p=async(e,t,s)=>{let a=(0,u.JU)(g,"tags",e),r=await (0,u.QT)(a);if(r.exists()){let e=r.data();await (0,u.pl)(a,{...e,totalFiles:e.totalFiles+1,lastAddedFileUrl:t},{merge:!0})}else{await (0,u.pl)(a,{name:e,totalFiles:1,lastAddedFileUrl:t,createdBy:s.id,createdAt:new Date});let r=(0,u.JU)(g,"users",s.id),l=await (0,u.QT)(r);if(l.exists()){let t=l.data().createdTags||[];t.push(e),await (0,u.r7)(r,{createdTags:t})}}};var v=s(7453);let b=async(e,t)=>{let s=(0,u.JU)(h.db,"users",e),a=await (0,u.QT)(s);if(a.exists()){let e=a.data(),r=(e.totalFileUploads||0)+1,l=e.recentFiles||[];l.unshift(t),l.length>3&&(l=l.slice(0,3)),await (0,u.r7)(s,{totalFileUploads:r,recentFiles:l})}else throw Error("Utilisateur non trouv\xe9")};var j=s(8786),w=s(2126),y=(0,o.Z)(()=>{let[e,t]=(0,r.useState)([]),[s,o]=(0,r.useState)(""),[d,u]=(0,r.useState)([]),[h,m]=(0,r.useState)(0),[f,g]=(0,r.useState)(!1),[y,N]=(0,r.useState)(!1),[k,C]=(0,r.useState)(0),{user:P}=(0,v.a)(),{tags:S}=(0,j.e)(),E=s=>{if(""===s.trim())return;let a=[...e];a[h].tags=(0,c.Pn)(a[h].tags,s),t(a),o(""),u([])},D=s=>{let a=[...e];a[h].tags=a[h].tags.filter(e=>e!==s),t(a)},F=async()=>{N(!0),C(0);try{for(let t=0;t<e.length;t++){let s=e[t],a=x(s.file,s.file.type.startsWith("image")?"image":"video",s.tags,P,e=>C(e)),r=await a;for(let e of s.tags)await p(e,r,P);await b(null==P?void 0:P.id,r),(0,w.XA)()}t([]),m(0),o(""),C(100)}catch(e){console.error("Erreur lors de l'upload :",e)}finally{N(!1)}},{getRootProps:z,getInputProps:A}=(0,l.uI)({onDrop:e=>{let s=e.map(e=>({id:e.name+Date.now(),file:e,preview:URL.createObjectURL(e),tags:[]}));t(e=>[...e,...s]),g(!1)},onDragEnter:()=>g(!0),onDragLeave:()=>g(!1)});return(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"bg-dark1 min-h-screen p-8 pb-16 lg:pb-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-6 font-title lg:ml-0 ml-6",children:"Ajouter un M\xe9dia"}),(0,a.jsxs)("div",{...z(),className:"border-2 border-dashed p-8 rounded-md flex justify-center items-center cursor-pointer transition-colors duration-200 ".concat(f?"border-greenPrimary bg-dark3":"border-gray-500 bg-dark2"),children:[(0,a.jsx)("input",{...A()}),(0,a.jsx)("p",{className:"text-gray-400 font-body",children:"Glissez et d\xe9posez des fichiers ici, ou cliquez pour s\xe9lectionner"})]}),e.length>0&&(0,a.jsxs)("div",{className:"mt-6 max-w-lg mx-auto",children:[(0,a.jsxs)("div",{className:"text-white mb-4 font-bold font-subtitle text-center",children:[h+1," sur ",e.length]}),(0,a.jsxs)("div",{className:"bg-dark2 p-4 rounded-lg shadow-md w-full",children:[e[h].file.type.startsWith("video")?(0,a.jsx)("video",{src:e[h].preview,controls:!0,className:"w-full h-auto object-contain rounded-md mb-4"}):(0,a.jsx)(i.Z,{children:(0,a.jsx)("img",{src:e[h].preview,alt:"Image active",className:"w-full h-auto object-contain rounded-md mb-4 cursor-pointer"})}),(0,a.jsx)("div",{className:"text-white font-bold font-subtitle mb-2 text-center",children:e[h].tags.join(" ")})]}),y?(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:(0,a.jsx)("div",{className:"bg-greenPrimary h-2.5 rounded-full",style:{width:"".concat(k,"%")}})}),(0,a.jsxs)("p",{className:"text-center text-white mt-2 font-body",children:[k,"%"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center mt-4 w-full relative",children:[(0,a.jsx)("input",{type:"text",value:s,onChange:e=>{let t=e.target.value.toLowerCase();o(t),t.length>0?u(S.filter(e=>e.toLowerCase().includes(t))):u([])},placeholder:"Ajouter un tag",className:"bg-dark3 text-white p-2 rounded-md focus:outline-none font-body w-full mr-2"}),(0,a.jsx)("button",{onClick:()=>E(s),className:"bg-greenPrimary text-white px-3 py-2 rounded-md font-body ".concat(""===s.trim()?"opacity-50 cursor-not-allowed":"hover:bg-green-600"),disabled:""===s.trim(),children:"Ajouter"}),d.length>0&&(0,a.jsx)("div",{className:"absolute top-full mt-2 w-full bg-dark3 rounded-md shadow-lg max-h-40 overflow-y-auto z-10",children:d.map(e=>(0,a.jsx)("div",{className:"p-2 hover:bg-dark2 cursor-pointer text-white",onClick:()=>E(e),children:e},e))})]}),(0,a.jsx)("div",{className:"flex flex-wrap mt-4",children:e[h].tags.map(e=>(0,a.jsxs)("span",{className:"bg-gray-700 text-white px-2 py-1 rounded-lg mr-2 mb-2 font-body flex items-center",children:[e," ",(0,a.jsx)("button",{onClick:()=>D(e),className:"ml-2 text-redPrimary",children:"\xd7"})]},e))}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)("button",{onClick:F,className:"bg-greenPrimary text-white px-4 py-2 rounded-md font-body w-full ".concat(0===e[h].tags.length?"opacity-50 cursor-not-allowed":"hover:bg-green-600"),disabled:0===e[h].tags.length,children:"Upload Fichier"})})]})]})]})})})},466:function(e,t,s){"use strict";s.d(t,{FilesProvider:function(){return o},Y:function(){return c}});var a=s(7437),r=s(2265),l=s(9842),i=s(3908);let n=(0,r.createContext)(void 0),o=e=>{let{children:t}=e,[s,o]=(0,r.useState)(0),[c,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{try{let e=await (0,l.PL)((0,l.hJ)(i.db,"files"));o(e.size)}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration du nombre total de fichiers :",e)}finally{d(!1)}})()},[]),(0,a.jsx)(n.Provider,{value:{totalFiles:s,loadingFiles:c},children:t})},c=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useFiles must be used within a FilesProvider");return e}},8786:function(e,t,s){"use strict";s.d(t,{TagProvider:function(){return o},e:function(){return c}});var a=s(7437),r=s(2265),l=s(9842),i=s(3908);let n=(0,r.createContext)(void 0),o=e=>{let{children:t}=e,[s,o]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[m,f]=(0,r.useState)(0);return(0,r.useEffect)(()=>{(async()=>{try{let e=(0,l.IO)((0,l.hJ)(i.db,"tags"),(0,l.Xo)("name","asc")),t=await (0,l.PL)(e),s=t.docs.map(e=>e.id),a=t.docs.map(e=>({id:e.id,data:e.data()}));o(s),d(a),f(t.size)}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des tags :",e)}finally{h(!1)}})()},[]),(0,a.jsx)(n.Provider,{value:{tags:s,tagsWithData:c,loadingTags:u,totalTags:m},children:t})},c=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useTags must be used within a TagProvider");return e}},7453:function(e,t,s){"use strict";s.d(t,{UserProvider:function(){return d},a:function(){return u}});var a=s(7437),r=s(2265),l=s(6463),i=s(3908),n=s(9842),o=s(5186);let c=(0,r.createContext)(void 0),d=e=>{let{children:t}=e,[s,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[m,f]=(0,r.useState)(!0),x=(0,l.useRouter)();(0,r.useEffect)(()=>{let e=(0,o.Aj)(i.I,async e=>{if(e){let t=(0,n.JU)(i.db,"users",e.uid),s=(0,n.cf)(t,t=>{if(t.exists()){let s={...t.data(),id:e.uid};d(s),s.isValidated||x.push("/account-validation")}else d(null);f(!1)}),a=(0,n.hJ)(i.db,"users"),r=(0,n.cf)(a,e=>{h(e.docs.map(e=>({...e.data(),id:e.id})))});return()=>{s(),r()}}d(null),f(!1)});return()=>e()},[x]);let g=async()=>{try{await (0,o.w7)(i.I),d(null),x.push("/")}catch(e){console.error("Erreur lors de la d\xe9connexion :",e)}};return(0,a.jsx)(c.Provider,{value:{user:s,allUsers:u,loading:m,logout:g},children:t})},u=()=>{let e=(0,r.useContext)(c);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},3908:function(e,t,s){"use strict";s.d(t,{I:function(){return n},db:function(){return o}});var a=s(5236),r=s(5186),l=s(9842);let i=(0,a.ZF)({apiKey:"AIzaSyA3nabauSNn32rLpKIkT5BoPnH8GYBMgEo",authDomain:"drivegazland.firebaseapp.com",projectId:"drivegazland",storageBucket:"drivegazland.appspot.com",messagingSenderId:"159250775284",appId:"1:159250775284:web:1a9bb56fcbd44938a832a1",measurementId:"G-0TF1NK3MC2"}),n=(0,r.v0)(i),o=(0,l.ad)(i)},3390:function(e,t,s){"use strict";var a=s(7437),r=s(2265),l=s(6648),i=s(4589),n=s(842),o=s(4413),c=s(9651),d=s(6730),u=s(2103),h=s(6463),m=s(7453),f=s(8786),x=s(466);t.Z=e=>{let{children:t}=e,[s,g]=(0,r.useState)(!1),p=(0,h.useRouter)(),{logout:v}=(0,m.a)(),{totalTags:b}=(0,f.e)(),{totalFiles:j,loadingFiles:w}=(0,x.Y)(),y=async()=>{try{await v(),p.push("/")}catch(e){console.error("Erreur lors de la d\xe9connexion\xa0:",e)}},N=()=>{p.push("/profile")},k=()=>{g(!1)};return(0,r.useEffect)(()=>{s?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[s]),(0,a.jsxs)("div",{className:"flex relative",children:[!s&&(0,a.jsx)("button",{className:"lg:hidden fixed top-8 left-4 z-50 text-white",onClick:()=>g(!s),children:(0,a.jsx)(i.Z,{className:"w-8 h-8"})}),s&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30",onClick:k}),(0,a.jsx)("aside",{className:"fixed top-0 left-0 z-40 w-[75%] lg:w-[20%] h-screen bg-dark2 text-white transform ".concat(s?"translate-x-0":"-translate-x-full"," transition-transform duration-300 ease-in-out lg:translate-x-0"),children:(0,a.jsx)("div",{className:"flex flex-col h-full px-4 py-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-8 md:mb-12",children:(0,a.jsx)(l.default,{src:"/images/GazlandprojetDashboard.png",alt:"Logo",layout:"intrinsic",width:250,height:125,className:"h-6"})}),(0,a.jsxs)("ul",{className:"space-y-2 font-medium",children:[(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"/dashboard",className:"flex items-center p-2 text-gray-100 rounded-lg dark:text-white hover:bg-gray-700 hover:text-white transition duration-150 ease-in-out",onClick:k,children:[(0,a.jsx)(n.Z,{className:"w-6 h-6 text-gray-400 group-hover:text-white"}),(0,a.jsx)("span",{className:"ml-3",children:"Accueil"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"/ranking",className:"flex items-center p-2 text-gray-100 rounded-lg dark:text-white hover:bg-gray-700 hover:text-white transition duration-150 ease-in-out",onClick:()=>{p.push("/ranking")},children:[(0,a.jsx)(o.Z,{className:"w-6 h-6 text-gray-400 group-hover:text-white"}),(0,a.jsx)("span",{className:"ml-3",children:"Classement"})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"#",className:"flex items-center p-2 text-gray-100 rounded-lg dark:text-white hover:bg-gray-700 hover:text-white transition duration-150 ease-in-out",onClick:()=>{N(),k()},children:[(0,a.jsx)(c.Z,{className:"w-6 h-6 text-gray-400 group-hover:text-white"}),(0,a.jsx)("span",{className:"ml-3",children:"Mon Profil"})]})})]}),(0,a.jsxs)("div",{className:"mt-8 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-dark3",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(d.Z,{className:"w-6 h-6 me-2"}),"Tous les fichiers"]}),(0,a.jsx)("span",{className:"bg-gray-700 text-xs rounded-md px-2 py-1",children:j})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-dark3",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(d.Z,{className:"w-6 h-6 me-2"}),"Tous les dossiers"]}),(0,a.jsx)("span",{className:"bg-gray-700 text-xs rounded-md px-2 py-1",children:b})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("button",{onClick:y,className:"flex items-center w-full p-2 rounded-lg hover:bg-gray-700 hover:text-white transition duration-150 ease-in-out",children:[(0,a.jsx)(u.Z,{className:"w-6 h-6 text-gray-400"}),(0,a.jsx)("span",{className:"ml-3",children:"D\xe9connexion"})]})})]})})}),(0,a.jsx)("div",{className:"flex-1 ml-0 lg:ml-[20%] ",children:t})]})}},4364:function(e,t,s){"use strict";s.d(t,{Pn:function(){return r},zK:function(){return l}});let a=e=>e.trim().toLowerCase(),r=(e,t)=>{let s=a(t);return e.includes(s)?e:[...e,s]},l=e=>{let t=Math.floor(Math.random()*e.length);return e[t]}},2126:function(e,t,s){"use strict";s.d(t,{Eo:function(){return d},QT:function(){return u},XA:function(){return c}});var a=s(7437),r=s(3580),l=s(6648),i=s(4364);let n=["Psartek \uD83C\uDF89","Pas mal elle","Mets les nudes de ta soeur plutot \uD83D\uDC4D","Ho ouai","Ho ouai","Ho ouai","Gors","Sa va","Pas mal","chaque upload fait grandir de 1 cm ton sexe","Bien jou\xe9 !","Ha ouai j'aime bien elle","ez","gg","Sa manque de hentai tout sa","ok super","Basique","C'est pas mal","ha ouai m'en souviens de celle la","J'aime bien","J'aime bien celle la","Tu peux faire mieux","si c'est pour upload sa..."],o=["Oups, quelque chose s'est mal pass\xe9 ! \uD83D\uDE15","merde j'ai cass\xe9 un truc","oula... c'est pas bon","saint jos\xe9 des le matin, me sent pas bien"],c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||(0,i.zK)(n);r.Am.success((0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{style:{width:"75px",height:"75px",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"flex-start"},children:(0,a.jsx)(l.default,{src:"/images/toast/success-icon.png",alt:"Success",layout:"intrinsic",width:75,height:75})}),(0,a.jsx)("span",{className:"flex-grow text-left ml-3",style:{color:"#ffffff"},children:t})]}),{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",icon:!1,style:{backgroundColor:"#1C7B47",color:"#ffffff"}})},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||(0,i.zK)(o);r.Am.error((0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{style:{width:"75px",height:"75px",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"flex-start"},children:(0,a.jsx)(l.default,{src:"/images/toast/error-icon.png",alt:"Error",layout:"intrinsic",width:75,height:75})}),(0,a.jsx)("span",{className:"flex-grow text-left ml-3",style:{color:"#ffffff"},children:t})]}),{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",icon:!1,style:{backgroundColor:"#D62839",color:"#ffffff"}})},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.Am.error((0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{style:{width:"75px",height:"75px",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"flex-start"},children:(0,a.jsx)(l.default,{src:"/images/toast/mock-icon.png",alt:"Mock",layout:"intrinsic",width:75,height:75})}),(0,a.jsx)("span",{className:"flex-grow text-left ml-3",style:{color:"#ffffff"},children:e||"Ceci est un toast moqueur ! \uD83D\uDE1C"})]}),{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",icon:!1,style:{backgroundColor:"#FAA613",color:"#ffffff"}})}},263:function(e,t,s){"use strict";var a=s(7437),r=s(2265),l=s(6463),i=s(7453);t.Z=e=>t=>{let{user:s,loading:n}=(0,i.a)(),o=(0,l.useRouter)(),c=(0,l.usePathname)();return((0,r.useEffect)(()=>{n||(s?s.isValidated||"/account-validation"===c||o.push("/account-validation"):o.push("/"))},[s,n,o,c]),!n&&s&&(s.isValidated||"/account-validation"===c))?(0,a.jsx)(e,{...t}):null}}},function(e){e.O(0,[43,358,691,72,648,580,239,437,971,23,744],function(){return e(e.s=560)}),_N_E=e.O()}]);