(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8861:function(e,t,s){Promise.resolve().then(s.bind(s,1813))},1813:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return k}});var l=s(7437),a=s(2265),n=s(3390),i=s(6463),r=s(4380),d=s(2023),c=s(8786),o=s(466),m=s(4768),x=e=>{let{greetingText:t,onSearchResults:s}=e,n=(0,i.useRouter)(),{tags:x}=(0,c.e)(),{searchFilesByTags:h}=(0,o.Y)(),[u,g]=(0,a.useState)(""),[p,f]=(0,a.useState)([]),[j,b]=(0,a.useState)([]);(0,a.useEffect)(()=>{u.length>0?f(x.filter(e=>e.toLowerCase().startsWith(u.toLowerCase())).slice(0,5)):f([])},[u,x]);let v=e=>{j.includes(e)||b(t=>[...t,e]),g(""),f([])},w=e=>{b(t=>t.filter(t=>t!==e))};return(0,a.useEffect)(()=>{j.length>0?h(j).then(e=>{s(e)}):s([])},[j,h,s]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("header",{className:"bg-dark2 px-8 py-7 flex justify-between items-center",children:[(0,l.jsx)("h2",{className:"text-white text-lg md:text-3xl ml-6 hidden lg:block",children:t}),(0,l.jsxs)("div",{className:"flex items-center w-full lg:w-2/3 ml-6 justify-between",children:[(0,l.jsxs)("div",{className:"relative flex items-center bg-dark3 rounded-lg w-full lg:w-3/4 mr-4",children:[(0,l.jsx)(r.Z,{className:"w-5 h-5 text-gray-400 ml-2"}),(0,l.jsx)("input",{type:"text",placeholder:"Rechercher des tags...",value:u,onChange:e=>g(e.target.value),className:"w-full px-2 py-2 bg-dark3 text-white placeholder-gray-400 rounded-lg focus:outline-none"}),p.length>0&&(0,l.jsx)("div",{className:"absolute top-full mt-2 w-full bg-dark3 rounded-md shadow-lg max-h-40 overflow-y-auto z-10",children:p.map(e=>(0,l.jsx)("div",{className:"p-2 hover:bg-dark2 cursor-pointer text-white",onClick:()=>v(e),children:e},e))})]}),(0,l.jsxs)("button",{onClick:()=>{n.push("/uploadMedia")},className:"flex items-center bg-greenPrimary text-white px-2 py-2 rounded-lg hover:bg-green-600 transition duration-150 ease-in-out whitespace-nowrap",children:[(0,l.jsx)(d.Z,{className:"w-7 h-7 mr-0 md:mr-2"}),(0,l.jsx)("span",{className:"hidden md:inline",children:"Ajouter un m\xe9dia"})]})]})]}),j.length>0&&(0,l.jsx)("div",{className:"bg-dark1 py-4 px-8",children:(0,l.jsx)("div",{className:"flex flex-wrap justify-center",children:j.map((e,t)=>(0,l.jsx)(m.Z,{text:e,onRemove:()=>w(e)},t))})})]})},h=s(2549),u=s(3617),g=s(6218),p=s(1725),f=s(2560),j=s(7206),b=e=>{let t,{files:s,currentIndex:n,onClose:i}=e,[r,d]=(0,a.useState)(n),c=s[r],o=()=>{d(e=>e===s.length-1?0:e+1)},m=()=>{d(e=>0===e?s.length-1:e-1)},x=(0,j.QS)({onSwipedLeft:o,onSwipedRight:m,preventScrollOnSwipe:!0,trackMouse:!0});return(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4",onClick:i,children:(0,l.jsxs)("div",{className:"relative w-full max-w-3xl max-h-[85vh] bg-dark3 rounded-lg shadow-lg overflow-hidden",onClick:e=>e.stopPropagation(),...x,children:[(0,l.jsxs)("div",{className:"bg-dark2 py-2 px-4 flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-white text-lg truncate w-full",children:c.title}),(0,l.jsx)("button",{onClick:i,className:"text-white",children:(0,l.jsx)(u.Z,{className:"w-6 h-6"})})]}),(0,l.jsx)("div",{className:"flex items-center justify-center w-full h-full max-h-[70vh] p-4 overflow-hidden",children:(t=c.imageSrc).includes("video")||t.endsWith(".mp4")||t.endsWith(".mov")||t.endsWith(".avi")?(0,l.jsx)("video",{src:c.imageSrc,className:"max-w-full max-h-full object-contain",controls:!0,autoPlay:!0}):(0,l.jsx)("img",{src:c.imageSrc,alt:c.title,className:"max-w-full max-h-full object-contain",style:{maxHeight:"calc(70vh - 4rem)",maxWidth:"100%"}})}),(0,l.jsx)("button",{onClick:m,className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-white text-5xl md:text-6xl lg:text-7xl p-2",children:"‹"}),(0,l.jsx)("button",{onClick:o,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-white text-5xl md:text-6xl lg:text-7xl p-2",children:"›"}),(0,l.jsxs)("div",{className:"bg-dark2 py-3 px-4 flex flex-col md:flex-row justify-around space-y-4 md:space-y-0 md:space-x-4",children:[(0,l.jsxs)("button",{className:"bg-greenPrimary text-white px-4 py-2 rounded-md flex items-center justify-center md:inline-block",children:[(0,l.jsx)(g.Z,{className:"w-5 h-5 md:hidden"}),(0,l.jsx)("span",{className:"hidden md:inline",children:"T\xe9l\xe9charger"})]}),(0,l.jsxs)("button",{className:"bg-greenPrimary text-white px-4 py-2 rounded-md flex items-center justify-center md:inline-block",children:[(0,l.jsx)(p.Z,{className:"w-5 h-5 md:hidden"}),(0,l.jsx)("span",{className:"hidden md:inline",children:"Favoris"})]}),(0,l.jsxs)("button",{className:"bg-redPrimary text-white px-4 py-2 rounded-md flex items-center justify-center md:inline-block",children:[(0,l.jsx)(f.Z,{className:"w-5 h-5 md:hidden"}),(0,l.jsx)("span",{className:"hidden md:inline",children:"Supprimer"})]})]})]})})};let v=e=>(null==e?void 0:e.includes("video"))||(null==e?void 0:e.endsWith(".mp4"))||(null==e?void 0:e.endsWith(".mov"))||(null==e?void 0:e.endsWith(".avi"));var w=e=>{let{files:t,isTagView:s=!1}=e,n=(0,a.useRef)([]),[i,r]=(0,a.useState)(null);(0,a.useEffect)(()=>{n.current.forEach(e=>{e&&(e.currentTime=0,e.pause())})},[t]);let d=e=>{s||r(e)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 p-4 sm:p-8 md:px-16",children:t.map((e,t)=>(0,l.jsxs)("div",{className:"bg-dark2 rounded-lg shadow-md p-4 cursor-pointer transition duration-150 ease-in-out ".concat(s?"":"hover:bg-dark3"),onClick:()=>d(t),children:[v(e.imageSrc)?(0,l.jsx)("video",{ref:e=>{n.current[t]=e},className:"w-full h-32 md:h-40 object-cover rounded-md mb-4",src:e.imageSrc,muted:!0,controls:!1,onLoadedData:e=>e.currentTarget.currentTime=0}):(0,l.jsx)("img",{src:e.imageSrc,alt:e.title,className:"w-full h-32 md:h-40 object-cover rounded-md mb-4"}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h3",{className:"text-white font-bold text-sm md:text-lg",children:e.title.length>12?"".concat(e.title.slice(0,12),"..."):e.title}),(0,l.jsx)("span",{className:"bg-gray-700 text-xs text-white rounded-md px-2 py-1",children:e.totalFiles})]})]},e.id))}),null!==i&&(0,l.jsx)(b,{files:t,currentIndex:i,onClose:()=>{r(null)}})]})},N=s(263),y=s(7453),k=(0,N.Z)(()=>{let{user:e}=(0,y.a)(),{tagsWithData:t,loadingTags:s}=(0,c.e)(),[i,r]=(0,a.useState)("Tous les fichiers"),[d,o]=(0,a.useState)([]);console.log(t,"tagsWithData");let m=d.map(e=>{var t;return{id:e.id,imageSrc:e.url,title:e.name,totalFiles:(null===(t=e.tags)||void 0===t?void 0:t.length)||1}}),u=t.map(e=>({id:e.id,imageSrc:e.data.lastAddedFileUrl,title:e.data.name,totalFiles:e.data.totalFiles||1})),g=d.length>0?m:u;return console.log(g,"filesToDisplay"),(0,l.jsxs)(n.Z,{children:[(0,l.jsx)(x,{greetingText:"Bienvenue, ".concat(null==e?void 0:e.pseudonym," !"),onSearchResults:o}),0===d.length&&(0,l.jsx)(h.Z,{categories:["Tous les fichiers","Favoris"],selectedCategory:i,onCategorySelect:r}),(0,l.jsx)("div",{className:"min-h-screen bg-dark1",children:s?(0,l.jsx)("p",{children:"Chargement des tags..."}):(0,l.jsx)(w,{files:g,isTagView:0==d.length})})]})})},2549:function(e,t,s){"use strict";var l=s(7437);s(2265),t.Z=e=>{let{categories:t,selectedCategory:s,onCategorySelect:a}=e;return(0,l.jsxs)("div",{className:"bg-dark1 p-4 sm:p-8 md:p-16 md:pb-0",children:[(0,l.jsx)("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white mb-4",children:s}),(0,l.jsx)("div",{className:"flex space-x-2 sm:space-x-4 overflow-x-auto",children:t.map(e=>(0,l.jsx)("button",{onClick:()=>a(e),className:"px-3 py-1 sm:px-4 sm:py-2 rounded-md text-sm sm:text-md md:text-lg transition duration-150 ease-in-out ".concat(s===e?"bg-dark3 text-white":"bg-transparent text-gray-400 opacity-80"," hover:bg-dark2 hover:text-white"),children:e},e))})]})}},4768:function(e,t,s){"use strict";var l=s(7437);s(2265),t.Z=e=>{let{text:t,onRemove:s}=e;return(0,l.jsxs)("span",{className:"bg-greenPrimary text-white px-4 py-2 rounded-lg mr-2 mb-2 font-body flex items-center",children:[t,(0,l.jsx)("button",{onClick:s,className:"ml-4 text-black hover:text-red-500 text-2xl font-bold focus:outline-none",children:"\xd7"})]})}}},function(e){e.O(0,[358,691,431,666,20,971,23,744],function(){return e(e.s=8861)}),_N_E=e.O()}]);